# 3. HTTP 메시지

이번 장에 배울 내용.

- 메시지가 어떻게 흘러가는가
- HTTP 메시지의 세 부분(시작줄, 헤더, 개체 본문)
- 요청과 응답 메시지의 차이
- 요청 메시지가 지원하는 여러 기능(메서드)들
- 응답 메시지가 반환하는 여러 상태 코드들
- 여러 HTTP 헤더들은 무슨 일을 하는가

# 3.1. 메세지의 흐름

HTTP 메시지는 HTTP 애플리케이션 간 주고 받은 데이터의 블록.

이 블록은 내용과 의미를 설명하는 텍스트 메타 정보로, 선택적으로 데이터도 올 수 있다.

메시지는 방향성이 있어 방향을 의미하는 용어가 쓰인다(인바운드, 아웃바운드, 업스트립, 다운스트림)

## 3.1.1. 메시지는 원 서버 방향을 인바운드로 하여 송신된다.

클라이언트에서 서버로 가는 방향이 인바운드, 반대를 아웃바운드라 한다.

## 3.1.2. 다운스트림으로 흐르는 메시지

클라이언트에서 요청을 보내든, 서버에서 응답을 보내는 목적지의 방향은 다운스트림이라 한다.

Proxy1 입장에서 Proxy2는 요청을 보낼 때는 다운스트림 방향이지만, 응답을 보낼 때는 업스트림이다.

![스크린샷 2023-04-25 오후 9.26.38.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/22d8cd15-7eb8-4b05-a33a-3cbc1729c0b3/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-04-25_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_9.26.38.png)

# 3.2. 메시지의 각 부분

시작줄, 헤더 블록, 본문 세 부분으로 구성된다.

HTTP 메시지는 어디가 헤더고 본문인지 명시하지 않지만 줄바꿈으로 구간을 구부한다. 줄 바꿈을 의미하는 특별한 문자열 CRLF(Carrage Return Line Feed)가 있는데 견고한 애플리케이션이라면 그냥 개행 문자도 받아들일 수 있어야 한다고 한다.

이 문자열은 ASCII 13(Carriage Return)과 ASCII 10(Line Feed)이다.

![스크린샷 2023-04-25 오후 9.29.38.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/462db16e-c18b-49b0-969d-52873c675251/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-04-25_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_9.29.38.png)

- 시작줄: HTTP/1.0 프로토콜로 응답 됐으며 상태 값은 200 메시지는 OK
- 헤더: 본문의 내용은 일반 텍스트고 길이가 19
- 본문: HI~ 라는 메시지

## 3.2.1. 메시지 문법

### 요청 메시지의 형식

```tsx
<메서드> <요청URL> <버전> 
<헤더>

<엔터티 본문>
```

### 응답 메시지의 형식(시작줄만 다름)

```tsx
<버전> <상태코드> <사유구절> 
<헤더>

<엔터티 본문>
```

### 설명

- 메서드
    
    GET, POST, PUT, HEAD 등 행위
    
- 요청 URL
    
    완전한 URL 또는 경로로 자원을 나타냄
    
- 버전
    
    HTTP 버전으로 HTTP/<메이저 버전>.<마이너 버전> 으로 나타냄
    
- 상태 코드
    
    요청 중 무엇이 일어났는지 설명하는 세 자리 숫자.
    
- 사유 구절
    
    숫자로 된 상태를 설명하는 메세지
    
- 헤더들
    
    optional 한 정보들로 메타나 
    
- 엔티티 본문
    
    임의의 바이너리 블록으로 많은 양의 데이터를 넣을 수 있는 공간. 없을 수도 있는데 이때에도 헤더가 끝났음을 알리는 CRLF 문자를 빼먹으면 안된다.
    

![스크린샷 2023-04-25 오후 9.37.15.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6a4595da-9458-4822-9961-71180510f0bd/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-04-25_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_9.37.15.png)

## 3.2.2. 시작줄

요청 메세지는 무엇을 해야 하는지, 응답 메시지는 무슨 일이 있어 났는지 말해준다.

### 요청줄

요청 메시지에서 무엇을 원하는지 나타낸다.

메서드는 GET, 리소스는 /test/hi-there.txt이고 프로토콜 버전은 HTTP/1.1. 요청 줄이라고도 한다.

### 응답줄

응답 메시지에서 보내는 수행 결과와 상태 정보, 결과 메시지.

응답한 프로토콜 버전과 상태 값 사유를 나타낸다.

### 메서드

`GET` 메소드는 특정 리소스의 표시를 요청합니다. `GET`을 사용하는 요청은 오직 데이터를 받기만 합니다.

`HEAD` 메소드는 `GET` 메소드의 요청과 동일한 응답을 요구하지만, 응답 본문을 포함하지 않습니다.

`POST` 메소드는 특정 리소스에 엔티티를 제출할 때 쓰입니다. 이는 종종 서버의 상태의 변화나 부작용을 일으킵니다.

`PUT` 메소드는 목적 리소스 모든 현재 표시를 요청 payload로 바꿉니다.

`DELETE` 메소드는 특정 리소스를 삭제합니다.

`CONNECT` 메소드는 목적 리소스로 식별되는 서버로의 터널을 맺습니다.

`OPTIONS` 메소드는 목적 리소스의 통신을 설정하는 데 쓰입니다.

`TRACE` 메소드는 목적 리소스의 경로를 따라 메시지 loop-back 테스트를 합니다.

`PATCH` 메소드는 리소스의 부분만을 수정하는 데 쓰입니다.

책에서는 OPTIONS은 어떤 메서드를 수행할 수 있는지 확인 한다고 돼 있다. 본격적인 요청을 하기 전에 OPTIONS 메소드를 보내는 것도 있다.

### 상태코드

100 - 정보 응답

200 - 성공 응답

300 - 리다이렉션 메시지

400 - 클라이언트 오류 응답

500 - 서버 오류 응답

### 사유구절

### 버전 번호

# 3.3. 메서드

## 3.3.1. 안전한 메서드

GET, HEAD를 안전한 메서드라 하는데, 서버에 어떤 데이터도 저장하지 않고 결과도 반영하지 않기 때문이다.

- GET - 리소스를 요청
- HEAD - 본문을 포함하지 않는 GET으로 리소스를 다 가져오지 않고 헤더나 시작줄의 정보만 알아볼 때 사용
- PUT - 전통적으론 리소스 위치에 사용자가 입력한 인터티 바디 내용을 넣은 페이지를 생성하는 것
- POST - 사용자가 입력한 데이터를 전송
- TRACE - 클라이언트에서 TRACE 메시지를 보내면 중간에 프록시 같은 애들이 헤더 쪽에 값을 넣어주고 서버쪽에서 루프백 진단을 한 다음 본문에 내용을 넣어 클라이언트에게 전달한다. 이때 클라이언트는 인터티 바디를 사용하지 않았다.
- OPTIONS - 사용 가능한 메서드를 알려준다.
- DELETE - 데이터를 지운다.